# NERD config (for NERDd only)
---
common_config: nerd.yml

# Number of worker processes
# WARNING: If changing number of worker processes, the following process must be followed:
# 1. stop all inputs (e.g. warden_receiver, updater)
# 2. when all queues are empty, stop all workers
# 3. reconfigure queues in RabbitMQ using /nerd/scripts/rmq_reconfigure.sh
# 4. change the settings here and in supervisord config (workers.ini)
# 5. reload supervisord and start everything again
worker_processes: 2

# Number of worker threads per process.
# This may be higher than number of CPUs, because this is not primarily intended
# to utilize computational power of multiple CPUs (which Python cannot do well
# anyway due to the GIL), but to mask long I/O operations (e.g. queries to
# external services via network)
worker_threads: 16

whois:
  asn_file: "/data/nerd-whois-asn.csv"
  ipv4_file: "/data/nerd-whois-ipv4.csv"

# Event type counter module determines which types of attacks exceed threshold during given time period
event_type_counter:
  # Number of last days which is used for event type counting (if value not present module counts all available events)
  days: 30
  # Threshold in percent (default value is 5)
  threshold: 5
  # Minimal number of total events in given time period to start attack type classification (default is 0 if value not present)
  min_num_of_events: 10

caida:
  # Caida list <www.caida.org/data/as-classification> which classifies business type of AS

  # File where list with ASes, source of classification and their type is stored
  # (Module is disabled if this is commented out)
  caida_file: "/data/caida-as2types.txt"

  # Source with confidence of right classification (default is 1 if source or confidence not present)
  sources:
    CAIDA_class:
      confidence: 0.7
    peerDB_class:
      confidence: 1
    manual_class:
      confidence: 1
  # Classes and their values which are stored in DB (class name from caida file is used if "value" or class not present)
  classes:
    Transit/Access:
      value: access
    Enterpise:
      value: enterprise
    Content:
      value: content

geolocation:
  geolite2_db_path: "/data/geoip/GeoLite2-City.mmdb"

dnsbl:
  # List of blacklists to query is located in the common nerd.yml

  # Use these nameservers instead of those configured in /etc/resolv.conf (optional)
  nameservers: [127.0.0.1]
  # Maximal number of requests made to every blacklist per day
  max_requests: 150000
  # File where daily count of requests is stored (this is only prefix to which date will be appended)
  req_cnt_file: "/data/dnsbl-requests-"

fmp:
  paths: {"general" : "/data/fmp/general/"}
  models: {"general" : "/data/fmp/models/model_access_nerd_xg200_7.bin"}

#shodan:
#   apikey: ""
