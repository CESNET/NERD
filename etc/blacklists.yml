# NERD config - blacklists
# used by blacklists2redis.py script
---
# Redis settings
redis:
  host: localhost
  port: 6379
  db: 5

# List specification:
#   id (used as key in records),
#   name (for humans),
#   url (http(s):// or file://, if local file is used, it should be updated by external cron script)
#   regex to parse the file (should match on IP address) or empty if there are only IP addresses, one per line (lines beginning with '#' are ignored),
#   refresh time (cron-like specification of when the list should be updated (in UTC), see https://apscheduler.readthedocs.io/en/latest/modules/triggers/cron.html for details)
iplists:
- - feodo
  - Feodo tracker
  - https://feodotracker.abuse.ch/downloads/ipblocklist.txt
  - ""
  - hour: 4
    minute: 50
- - tor
  - TOR
  - http://torstatus.blutmagie.de/ip_list_exit.php
  - ""
  - hour: '6,18'
    minute: 50
- - ransomware
  - Ransomware (IP)
  - https://ransomwaretracker.abuse.ch/downloads/RW_IPBL.txt
  - "([0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]*)"
  - hour: 4
    minute: 50
- - bruteforceblocker
  - Daniel Gerzo's BruteForceBlocker
  - http://danger.rulez.sk/projects/bruteforceblocker/blist.php
  - "^([0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]*)"
  - hour: 4
    minute: 52
- - urlvir
  - URL Vir
  - http://www.urlvir.com/export-ip-addresses
  - "[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}"
  - hour: 6
    minute: 0
- - andoniafMiners
  - Andoniaf Miners
  - https://raw.githubusercontent.com/andoniaf/mining-pools-list/master/mining-pools_IP.lst
  - ""
  - hour: 4
    minute: 50
- - ciarmy
  - CI Army - BadGuys
  - http://cinsscore.com/list/ci-badguys.txt
  - ""
  - hour: 4
    minute: 50
- - malc0de
  - Malc0de
  - https://malc0de.com/bl/IP_Blacklist.txt
  - ""
  - hour: 4
    minute: 50
# The following blacklists should be rsynced to local files by scripts in
# cron, therefore they're not available until those scripts are set up and
# therefore they're disabled by default.
#- - uceprotect
#  - UCEPROTECT Level 1
#  - file:///data/blacklists/uceprotect-level1
#  - "^([0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]*)$"
#  - hour: 1,9,17
#    minute: 45
#- - psbl
#  - PSBL (spam)
#  - file:///data/blacklists/psbl.txt
#  - "^([0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]*)$"
#  - hour: 1,9,17
#    minute: 45

# Lists of IP ranges or CIDR prefixes.
# Same format as in normal iplists is used, except 'regex'. If the prefix is formatted as start and end of IP network,
# then start of IP network should be caught as group 1 in regex and end of IP network should be caught as group 2
# (without regex, CIDR format is assumed)
prefixiplists:
- - dshield
  - DShield.org Recommended Block List
  - https://www.dshield.org/block.txt
  - "([0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})\\s*([0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})"
  - hour: 4
    minute: 50
#- - amazonAWS
#  - Amazon AWS
#  - https://ip-ranges.amazonaws.com/ip-ranges.json
#  - "\"ip_prefix\": \"([0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\/[0-9]{1,2})\""
#  - hour: 4
#    minute: 50

domainlists:
- - ransomware
  - Ransomware (domains)
  - https://ransomwaretracker.abuse.ch/downloads/RW_DOMBL.txt
  - ""
  - hour: 4
    minute: 50
- - malwaredomains
  - malwaredomains.com
  - http://mirror2.malwaredomains.com/files/domains.txt
  - "^\\t\\t([^\\s]*)"
  - hour: 4
    minute: 55
- - openphish
  - openphis.com
  - https://openphish.com/feed.txt
  - ""
  - hour: 4
    minute: 50
- - booters
  - Booters
  - https://raw.githubusercontent.com/jjsantanna/booters_ecosystem_analysis/master/booterblacklist.csv
  - "^[0-9]*?,(.*?)$"
  - hour: 4
    minute: 50

