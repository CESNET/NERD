# NERD config - blacklists
# used by blacklists2redis.py script
---
# Redis settings
redis:
  host: localhost
  port: 6379
  db: 5

# List specification:
#   id (used as key in records),
#   name (for humans),
#   url (http(s):// or file://, if local file is used, it should be updated by external cron script)
#   regex to parse the file (should match on IP address) or empty if there are only IP addresses, one per line (lines beginning with '#' are ignored),
#       or just fill regex with searching for IP, IP prefix or domain without group, if the whole blacklist is on one line or has multiple records on on line
#       - you can use special substitutions for IP address or CIDR IP address
#         - "//A" can be used for IP address, in interal part it will be substituted for IP regex
#         - "//CA" can be used for CIDR prefix (192.168.0.0/16)
#       IP address regex example, where IP address starts on every line:
#         "^(//A)"
#   refresh time (cron-like specification of when the list should be updated (in UTC), see https://apscheduler.readthedocs.io/en/latest/modules/triggers/cron.html for details)
#   other params (optional)
#
#   The last parameter is a dictionary of other parameters. The following keys are recognized:
#     url_params - dict of key-value pairs to pass as GET parameters in URL
#     headers - dict of key-value pairs specyfing additional HTTP headers
#   Example of url_params and headers usage can be viewed below in Abuse IP DB blacklist specification.
iplists:

- - andoniafMiners
  - Andoniaf Miners
  - https://raw.githubusercontent.com/andoniaf/mining-pools-list/master/mining-pools_IP.lst
  - ""
  - hour: 4
    minute: 50
- - tor_project_org_ips
  - TorProject.org IPs
  - https://check.torproject.org/torbulkexitlist
  - ""
# The time of updating the list was not found 
  - hour: "*/4"
  - minute: 10 
- - dan_me_uk_ips
  - dan.me.uk TOR Node List IPs
  - https://www.dan.me.uk/torlist/
  - ""
# The time of updating the list was viewed here: https://www.dan.me.uk/tornodes
  - hour: "*/4"
  - minute: 10

# Lists from FireHOL
- - firehol_anonymous
  - List of all anonymizing IPs of the world, aggregated from multiple lists by FireHOL.
  - https://iplists.firehol.org/files/firehol_anonymous.netset
  - "^(\\A)"
  - hour: "0,6,12,18"
    minute: 5

# Lists of IP ranges or CIDR prefixes.
# Same format as in normal iplists is used, except 'regex'. If the prefix is formatted as start and end of IP network,
# then start of IP network should be caught as group 1 in regex and end of IP network should be caught as group 2
# (without regex, CIDR format is assumed)
prefixiplists:
- - botscout_7d
  - BotScout.com
  - https://iplists.firehol.org/files/botscout_7d.ipset
  - ""
# The time of updating the list was viewed here: https://iplists.firehol.org/?ipset=botscout_7d
  - hour: "*/4"
  - minute: 10
- - dshield
  - DShield.org Recommended Block List
  - https://www.dshield.org/block.txt
  - "(\\A)\\s*(\\A)"
  - hour: 4
    minute: 50
#- - amazonAWS
#  - Amazon AWS
#  - https://ip-ranges.amazonaws.com/ip-ranges.json
#  - "\"ip_prefix\": \"(\\CA)\""
#  - hour: 4
#    minute: 50
- - spamhaus_edrop
  - Spamhaus Extended DROP List (EDROP)
  - https://www.spamhaus.org/drop/edrop.txt
  - "^(\\CA)"
  - hour: "0,6,12,18"
    minute: 5
domainlists:
- - krisk_intel_domains
  - KRISK INTEL domains
  - https://kriskintel.com/feeds/ktip_malicious_domains.txt
  - ""
# The time of updating the list was viewed in the file: https://kriskintel.com/feeds/ktip_malicious_domains.txt
  - hour: 7
  - minute: 0
- - openphish
  - openphis.com
  - https://openphish.com/feed.txt
  - ""
  - hour: 4
    minute: 50
- - booters
  - Booters
  - https://raw.githubusercontent.com/jjsantanna/booters_ecosystem_analysis/master/booterblacklist.csv
  - "^[0-9]*?,(.*?)$"
  - hour: 4
    minute: 50

